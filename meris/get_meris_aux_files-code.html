<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Tue Jul  2 12:50:55 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>get_meris_aux_files.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="get_meris_aux_files.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      GET_MERIS_AUX_FILES       </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      RETURNS A STRING ARRAY OF MERIS L1B AUXILIARY FILES</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RES = GET_MERIS_AUX_FILES(FILENAME,/VERBOSE)      </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      FILENAME - FULL PATH OF THE FILE TO BE ANALYSED      </span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      VERBOSE - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      AUX_FILES - A STRING ARRAY CONTAINING THE AUXILIARY FILENAME INFORMATION</span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*      22 NOV 2010 - C KENT    - DIMITRI-2 V1.0</span>
<span class="comments">;*      02 DEC 2010 - C KENT    - UPDATED HEADER INFORMATION</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*      01 DEC 2010 - C KENT    - WINDOWS 32-BIT MACHINE IDL 7.1: COMPILATION SUCCESSFUL,</span>
<span class="comments">;*                                AUX FILE DATA NOMINAL FOR MERIS L1B PRODUCT</span>
<span class="comments">;*                                (VALIDATED AGAINST BEAM)</span>
<span class="comments">;*      05 JAN 2010 - C KENT    - LINUX 64-BIT MACHINE IDL 8.0: COMPILATION SUCCESSFUL,</span>
<span class="comments">;*                                VALUES EQUAL TO WINDOWS 32-BIT MACHINE</span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
FUNCTION GET_MERIS_AUX_FILES,FILENAME,VERBOSE=VERBOSE

<span class="comments">;------------------------------------------------</span>
<span class="comments">; CHECK FILENAME IS A NOMINAL INPUT</span>

  IF FILENAME EQ '' THEN BEGIN
    PRINT, 'MERIS L1B AUX FILES: ERROR, INPUT FILENAME INCORRECT'
    RETURN,-1
  ENDIF

<span class="comments">;------------------------------------------------</span>
<span class="comments">;DEFINE HEADER VARIABLES</span>

  MPH_SIZE = 1247
  SPH_SIZE = 9942
  FILE_MPH = BYTARR(MPH_SIZE)
  FILE_SPH = BYTARR(SPH_SIZE)
  
<span class="comments">;-----------------------------------------------</span>
<span class="comments">; OPEN THE FILE AND EXTRACT HEADER</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B AUX FILES: OPENING PRODUCT'
  OPENR,PRD_AUX,FILENAME,/GET_LUN
  READU,PRD_AUX,FILE_MPH
  READU,PRD_AUX,FILE_SPH
  
<span class="comments">;-----------------------------------------------</span>
<span class="comments">; DEFINE OUTPUT ARRAY</span>

  NB_AUX_FILES = 10
  AUX_FILES = STRARR(NB_AUX_FILES)

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B AUX FILES: RETRIEVING DSD INFORMATION'
  AUX_DSD_POS =STRPOS(FILE_SPH,'DS_NAME="MERIS_SOURCE_PACKETS        "')

<span class="comments">;-----------------------------------------------</span>
<span class="comments">; IF NO DSD FOUND THEN TRY THE ACRI-ST NAME </span>
  
  IF AUX_DSD_POS LT 0 then AUX_DSD_POS =STRPOS(FILE_SPH,'DS_NAME="Level 0                     "')
  
<span class="comments">;----------------------------------------</span>
<span class="comments">; POINT TO THE MDS WITHIN THE FILE AND EXTRACT THE DATA</span>
    
  POINT_LUN, PRD_AUX, AUX_DSD_POS+MPH_SIZE
  AUX_DSD = BYTARR(280)
    
  FOR I=0,NB_AUX_FILES-1 DO BEGIN
    READU,PRD_AUX,AUX_DSD
    AUX_DSD_STR = STRING(AUX_DSD)
    AUX_FNAME_POS = STRPOS(AUX_DSD_STR,'FILENAME=')
    AUX_FILES[I]  = STRMID(AUX_DSD_STR,AUX_FNAME_POS+10,62)
  ENDFOR
  
<span class="comments">;---------------------------------------</span>
<span class="comments">; CLOSE THE FILE</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B AUX FILES: CLOSING PRODUCTS AND RELEASING THE LUN'
  CLOSE, PRD_AUX
  FREE_LUN, PRD_AUX

<span class="comments">;---------------------------------------</span>
<span class="comments">; RETURN ARRAY OF AUXILIARY DATA FILES</span>

  RETURN,AUX_FILES

END
</code>
    </div>
  </body>
</html>