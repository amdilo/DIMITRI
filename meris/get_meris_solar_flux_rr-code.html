<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Tue Jul  2 12:50:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>get_meris_solar_flux_rr.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="get_meris_solar_flux_rr.pro (Documentation for /home/marrabld/projects/DIMITRI_2.0/Source/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;*</span>
<span class="comments">;* NAME:</span>
<span class="comments">;*      GET_MERIS_SOLAR_FLUX_RR       </span>
<span class="comments">;* </span>
<span class="comments">;* PURPOSE:</span>
<span class="comments">;*      RETURNS THE SOLAR SPECTRAL FLUX FOR EACH MERIS DETECTOR</span>
<span class="comments">;* </span>
<span class="comments">;* CALLING SEQUENCE:</span>
<span class="comments">;*      RES = GET_MERIS_SOLAR_FLUX_RR()      </span>
<span class="comments">;* </span>
<span class="comments">;* INPUTS:</span>
<span class="comments">;*      NONE        </span>
<span class="comments">;*</span>
<span class="comments">;* KEYWORDS:</span>
<span class="comments">;*      FR      - RETRIEVE SPECTRAL FLUX FOR FULL RESOLUTION DETECTORS (DEFUALT IS RR)          </span>
<span class="comments">;*      VERBOSE - PROCESSING STATUS OUTPUTS</span>
<span class="comments">;*</span>
<span class="comments">;* OUTPUTS:</span>
<span class="comments">;*      MIM_RR  - A FLOAT ARRAY CONTAINING THE SPECTRAL FLUX FOR EACH DETECTOR AND BAND </span>
<span class="comments">;*</span>
<span class="comments">;* COMMON BLOCKS:</span>
<span class="comments">;*      NONE</span>
<span class="comments">;*</span>
<span class="comments">;* MODIFICATION HISTORY:</span>
<span class="comments">;*      30 JUL 2006 - M BOUVET - PROTOTYPE DIMITRI VERSION</span>
<span class="comments">;*      17 NOV 2010 - C KENT   - DIMITRI-2 V1.0</span>
<span class="comments">;*      22 NOV 2010 - C KENT   - ADDED VERBOSE KEYWORD OPTION</span>
<span class="comments">;*      01 DEC 2010 - C KENT   - ADDED AUX DATA FILE ERROR HANDLING</span>
<span class="comments">;*      02 DEC 2010 - C KENT   - UPDATED HEADER INFORMATION</span>
<span class="comments">;*      21 MAR 2011 - C KENT   - MODIFIED FILE DEFINITION TO USE GET_DIMITRI_LOCATION</span>
<span class="comments">;*</span>
<span class="comments">;* VALIDATION HISTORY:</span>
<span class="comments">;*      01 DEC 2010 - C KENT    - WINDOWS 32-BIT MACHINE: COMPILATION SUCCESSFUL, </span>
<span class="comments">;*                                VALIDATED AGAINST TEXTPAD (FR)/ MANUAL AVERAGING (RR)</span>
<span class="comments">;*      05 JAN 2010 - C KENT    - LINUX 64-BIT MACHINE IDL 8.0: COMPILATION SUCCESSFUL,</span>
<span class="comments">;*                                NO DIFFERENCES OBSERVED AGAINST WINDOWS 32-BIT MACHINE</span>
<span class="comments">;*</span>
<span class="comments">;**************************************************************************************</span>
<span class="comments">;**************************************************************************************</span>

FUNCTION GET_MERIS_SOLAR_FLUX_RR,FR=FR,VERBOSE=VERBOSE

  IF KEYWORD_SET(FR) AND KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: FULL RESOLUTION SELECTED'
  IF NOT KEYWORD_SET(FR) AND KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: REDCUED RESOLUTION SELECTED'

<span class="comments">;----------------------------------------</span>
<span class="comments">; DEFINE AUXILIARY DATA FILE</span>

  <span class="comments">;MIM2004 = './AUX_DATA/MERIS_Irradiances_Model2004.txt'</span>
  MIM2004 = GET_DIMITRI_LOCATION('MERIS_IM2004')
  
  TEMP = FILE_INFO(MIM2004)
  IF TEMP.EXISTS EQ 0 THEN BEGIN
  PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: ERROR, AUXILIARY DATA NOT FOUND'
  RETURN,-1
  ENDIF

<span class="comments">;----------------------------------------</span>
<span class="comments">; DEFINE DATA ARRAYS</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: DEFINING DATA ARRAYS'
  FR_SIZE = 3700
  RR_SIZE = 925
  MIM_HDR = STRING(1)
  MIM_FR  = fltarr(16, FR_SIZE)
  MIM_RR  = fltarr(16, RR_SIZE)
  LINE_COUNT = 0
  TEMP    = FLTARR(16)

<span class="comments">;----------------------------------------</span>
<span class="comments">; OPEN THE IRRADIANCE FILE AND READ THE HEADER</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: OPEN AUX DATA AND READ HEADER'
  OPENR,PRD_MIM,MIM2004,/GET_LUN
  READF,PRD_MIM,MIM_HDR

<span class="comments">;----------------------------------------</span>
<span class="comments">; READ EACH LINE OF THE FILE</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: EXTRACTING DATA FOR EACH LINE OF AUX DATA'
  WHILE NOT EOF(PRD_MIM)DO BEGIN
    
    READF,PRD_MIM,TEMP
    MIM_FR[*,LINE_COUNT]=TEMP
    LINE_COUNT++
  
  ENDWHILE

<span class="comments">;---------------------------------------</span>
<span class="comments">; CLOSE THE FILE</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: CLOSING THE FILE AND RETURING THE LUN'
  CLOSE, PRD_MIM
  FREE_LUN, PRD_MIM

  IF KEYWORD_SET(FR) THEN BEGIN
    IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: RETURNING FR SPECTRAL FLUX'
    RETURN,MIM_FR
  ENDIF
  
<span class="comments">;---------------------------------------</span>
<span class="comments">; CONVERT TO REDUCED RESOLUTION</span>

  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: CONVERTING TO REDCUED RESOLUTION'
  FOR MIM_IDX=0, RR_SIZE-1 do begin
    MIM_RR[0,MIM_IDX] = MIM_IDX
    FOR MIM_BND=1,15 DO BEGIN
          MIM_RR[MIM_BND,MIM_IDX]=MEAN(MIM_FR[MIM_BND, 4*MIM_IDX:4*(MIM_IDX+1)-1])
    ENDFOR
  ENDFOR
 
  IF KEYWORD_SET(VERBOSE) THEN PRINT, 'MERIS L1B SOLAR SPECTRUL FLUX: RETURNING RR SPECTRAL FLUX' 
  RETURN,MIM_RR 

END
</code>
    </div>
  </body>
</html>